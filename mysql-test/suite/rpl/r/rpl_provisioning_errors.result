include/rpl_provisioning_init.inc
SET GLOBAL debug_dbug="+d,provisioning_test_running";
SET GLOBAL debug_dbug="+d,provisioning_test_running";
RESET SLAVE;
CHANGE MASTER TO MASTER_USE_GTID= slave_pos;
DROP DATABASE test;
CHANGE MASTER TO MASTER_USE_GTID= no;
LOAD DATA FROM MASTER;
ERROR HY000: This operation cannot be performed as server is not configured to use GTID; run CHANGE MASTER TO MASTER_USE_GTID = {current_pos|slave_pos} first
CHANGE MASTER TO MASTER_USE_GTID= slave_pos;
START SLAVE SQL_THREAD;
LOAD DATA FROM MASTER;
ERROR HY000: This operation cannot be performed as you have a running slave ''; run STOP SLAVE '' first
STOP SLAVE SQL_THREAD;
CREATE TABLE test.t1 (a int);
INSERT INTO test.t1 VALUES (1), (2), (3), (4), (5);
call mtr.add_suppression("Slave I/O: Provisioning failed with error code 1977 and message: 'Table does not contain primary key' while processing `test`.`t1`, Internal MariaDB error code: 1977");
LOAD DATA FROM MASTER;
include/wait_for_slave_io_error.inc [errno=1977]
Last_IO_Error = 'Provisioning failed with error code 1977 and message: 'Table does not contain primary key' while processing `test`.`t1`'
RESET SLAVE;
CHANGE MASTER TO MASTER_USE_GTID= slave_pos;
DROP TABLE test.t1;
DROP DATABASE IF EXISTS test;
SET GLOBAL debug_dbug="+d,FORCE_SLAVE_TO_RECONNECT_DUMP";
call mtr.add_suppression("Slave I/O: Slave disconnected during provisioning, drop already provisioned databases from slave and try again, Internal MariaDB error code: 1979");
LOAD DATA FROM MASTER;
include/wait_for_slave_io_error.inc [errno=1979]
Last_IO_Error = 'Slave disconnected during provisioning, drop already provisioned databases from slave and try again'
STOP SLAVE;
RESET SLAVE;
CHANGE MASTER TO MASTER_USE_GTID= slave_pos;
SET GLOBAL debug_dbug="-d,FORCE_SLAVE_TO_RECONNECT_DUMP";
SET GLOBAL debug_dbug="";
SET GLOBAL debug_dbug="";
CREATE DATABASE test;
include/rpl_end.inc
