# MDEV-7502 Automatic provisioning of slave
# Tested functionality of LOAD DATA FROM MASTER - Fail after receiving
# query event when masters binlog_format != ROW

--source include/rpl_provisioning_init_mix_or_stmt.inc

# Wait with provisioning, only binlog events are important now
--connection master
SET GLOBAL debug_dbug="+d,provisioning_wait";
CREATE TABLE test.t1 (a int, PRIMARY KEY (a));

--connection slave
--source include/load_data_from_master.inc

--connection master
UPDATE test.t1 SET a= 1;
SET GLOBAL debug_dbug="-d,provisioning_wait";

# Expecting slave error
--connection slave
--let $slave_sql_errno= 1983
--source include/wait_for_slave_sql_error.inc
--source include/wait_for_slave_io_to_stop.inc

# Cleanup
--source include/rpl_provisioning_end.inc
